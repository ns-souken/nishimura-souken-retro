<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title>Nishimura Souken - Think Digital.</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <!-- Favicon and Web App Icons -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/svg+xml" href="assets/images/logo.svg">
    <link rel="apple-touch-icon" href="assets/images/logo.svg">
    <link rel="manifest" href="site.webmanifest">
    <meta name="theme-color" content="#C0C0C0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="西村総研">
    
    <!-- 80s Mac Style Meta -->
    <meta name="description" content="80年代Mac風デザインのデジタルマーケティング会社、西村総研のコーポレートサイト">
    <meta name="keywords" content="デジタルマーケティング,ECサイト制作,SNS運用,YouTube,TikTok,西村総研,80年代,レトロ">
    <meta name="author" content="Nishimura Souken">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z4M8GHJFRT"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-Z4M8GHJFRT');
    </script>
    
    <style>
        @font-face {
            font-family: 'KH-Dot-Hibiya';
            src: url('assets/fonts/KH-Dot-Hibiya-24.ttf') format('truetype');
            font-display: swap;
        }
        
        body {
            background-color: #C0C0C0;
            background-image: 
                radial-gradient(circle at 1px 1px, #808080 1px, transparent 0);
            background-size: 4px 4px;
            font-family: "KH-Dot-Hibiya", "Chicago", "MS UI Gothic", "MS Gothic", "東雲ゴシック", "Shinonome Gothic", "ドットゴシック16", "BM-mini", "ミニゴシック", "Osaka", "細明朝体", "Monaco", monospace;
            font-size: 9px;
            margin: 0;
            padding: 0;
            color: #000000;
        }
        
        /* モノクロ風カラーパレット */
        .color-black { color: #000000; }
        .color-darkgray { color: #404040; }
        .color-gray { color: #808080; }
        .color-lightgray { color: #C0C0C0; }
        .color-white { color: #FFFFFF; }
        
        /* 80年代風のテーブルスタイル */
        table {
            border-collapse: separate;
            border-spacing: 1px;
        }
        
        /* 古いMac風3Dボーダー */
        .mac-window {
            border: 2px outset #C0C0C0;
            background-color: #C0C0C0;
            box-shadow: 2px 2px 0px #404040;
        }
        
        .mac-button {
            border: 1px outset #C0C0C0;
            background-color: #E0E0E0;
            padding: 2px 8px;
            font-family: "KH-Dot-Hibiya", "Chicago", Monaco, monospace;
            font-size: 9px;
            text-decoration: none;
            color: #000000;
            display: inline-block;
        }
        
        .mac-button:hover {
            background-color: #D0D0D0;
        }
        
        .mac-button:active {
            border: 1px inset #C0C0C0;
        }
        
        .mac-inset {
            border: 2px inset #C0C0C0;
            background-color: #FFFFFF;
        }
        
        /* SVGロゴスタイル */
        .company-logo {
            width: 60px;
            height: 60px;
            display: inline-block;
            filter: contrast(1.1) brightness(0.95);
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        /* フォールバック用ヴィンテージロゴ */
        .vintage-logo {
            width: 60px;
            height: 60px;
            background-color: #000000;
            display: inline-block;
            position: relative;
            clip-path: polygon(30% 0%, 70% 0%, 85% 20%, 85% 80%, 70% 100%, 30% 100%, 15% 80%, 15% 20%);
        }
        
        .vintage-logo::after {
            content: "NS";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #FFFFFF;
            font-weight: bold;
            font-size: 24px;
            font-family: "KH-Dot-Hibiya", "Chicago", Monaco, monospace;
        }
        
        /* メニューバー風 */
        .menu-bar {
            background-color: #FFFFFF;
            border-bottom: 1px solid #000000;
            height: 20px;
            padding: 2px 5px;
        }
        
        .menu-item {
            font-family: "KH-Dot-Hibiya", "Chicago", "MS UI Gothic", "MS Gothic", "東雲ゴシック", "Monaco", monospace;
            font-size: 9px;
            color: #000000;
            text-decoration: none;
            padding: 0 8px;
            display: inline-block;
        }
        
        .menu-item:hover {
            background-color: #000000;
            color: #FFFFFF;
        }
        
        /* ダイアログボックス風 */
        .dialog-box {
            border: 2px outset #C0C0C0;
            background-color: #C0C0C0;
            padding: 10px;
            margin: 5px;
            box-shadow: 2px 2px 0px #404040;
        }
        
        .dialog-title {
            background-color: #000000;
            color: #FFFFFF;
            padding: 2px 5px;
            margin: -10px -10px 10px -10px;
            font-family: "KH-Dot-Hibiya", "Chicago", Monaco, monospace;
            font-size: 9px;
            font-weight: bold;
        }
        
        /* ビットマップ風アイコン */
        .bitmap-icon {
            width: 32px;
            height: 32px;
            background-color: #000000;
            display: inline-block;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        /* ドット絵風フォント効果 */
        .pixel-text {
            font-family: "Monaco", "東雲明朝", "Shinonome Mincho", "MS Gothic", "ドット明朝12", "BM-mini", "Courier New", monospace;
            font-size: 8px;
            letter-spacing: 1px;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        /* リンクスタイル（昔のブラウザ風） */
        a {
            color: #0000EE;
            text-decoration: underline;
        }
        
        a:visited {
            color: #551A8B;
        }
        
        a:hover {
            color: #FF0000;
        }
        
        /* 点滅テキスト */
        @keyframes blink-slow {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        .blink-vintage {
            animation: blink-slow 2s linear infinite;
        }
        
        /* マーキー風（元のソースから） */
        @keyframes scroll-left {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        
        .marquee {
            display: inline-block;
            white-space: nowrap;
            animation: scroll-left 15s linear infinite;
        }
        
        /* スクロールバー風装飾 */
        .scrollbar-decoration {
            width: 16px;
            height: 100px;
            background-color: #C0C0C0;
            border: 1px inset #C0C0C0;
            background-image: 
                linear-gradient(45deg, #808080 25%, transparent 25%),
                linear-gradient(-45deg, #808080 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #808080 75%),
                linear-gradient(-45deg, transparent 75%, #808080 75%);
            background-size: 4px 4px;
            background-position: 0 0, 0 2px, 2px -2px, -2px 0px;
        }
        
        /* タイトルバー */
        .title-bar {
            background-color: #C0C0C0;
            border: 1px outset #C0C0C0;
            padding: 2px 5px;
            font-family: "KH-Dot-Hibiya", "Chicago", "MS UI Gothic", "MS Gothic", "東雲ゴシック", "Monaco", monospace;
            font-size: 9px;
            font-weight: bold;
        }
        
        /* 古いフォームスタイル */
        .vintage-input {
            border: 2px inset #C0C0C0;
            background-color: #FFFFFF;
            font-family: "Monaco", Courier, monospace;
            font-size: 9px;
            padding: 2px;
        }
        
        /* System 6/7風のパターン */
        .system-pattern {
            background-image: 
                linear-gradient(45deg, #C0C0C0 25%, #808080 25%, #808080 50%, #C0C0C0 50%, #C0C0C0 75%, #808080 75%);
            background-size: 4px 4px;
        }
        
        /* HyperCard風 */
        .hypercard-button {
            background-color: #FFFFFF;
            border: 2px outset #C0C0C0;
            padding: 4px 12px;
            font-family: "KH-Dot-Hibiya", "Chicago", "MS UI Gothic", "MS Gothic", "東雲ゴシック", "Monaco", monospace;
            font-size: 9px;
            text-decoration: none;
            color: #000000;
            display: inline-block;
            box-shadow: 1px 1px 0px #808080;
        }
        
        .hypercard-button:hover {
            background-color: #F0F0F0;
        }
        
        .hypercard-button:active {
            border: 2px inset #C0C0C0;
            box-shadow: none;
        }
    </style>
</head>
<body>
    <center>
        <!-- メインウィンドウ -->
        <table width="640" cellpadding="0" cellspacing="0" border="0" class="mac-window">
            <!-- タイトルバー -->
            <tr>
                <td class="title-bar" colspan="2">
                    <table width="100%" cellpadding="0" cellspacing="0" border="0">
                        <tr>
                            <td>Nishimura Souken Corporate Site v1.0</td>
                            <td align="right">
                                <span style="font-family: Chicago, monospace;">□</span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            
            <!-- メニューバー -->
            <tr>
                <td class="menu-bar" colspan="2">
                    <a href="#" class="menu-item">File</a>
                    <a href="#" class="menu-item">Edit</a>
                    <a href="#services" class="menu-item">Services</a>
                    <a href="#about" class="menu-item">About</a>
                    <a href="#contact" class="menu-item">Contact</a>
                    <span style="float: right; font-family: Chicago, monospace;">⌘</span>
                </td>
            </tr>
            
            <!-- メインコンテンツエリア -->
            <tr>
                <td colspan="2" style="padding: 20px; background-color: #FFFFFF;">
                    <!-- ヘッダー情報 -->
                    <table width="100%" cellpadding="10" cellspacing="0" border="0">
                        <tr>
                            <td width="60" align="center">
                                <img src="assets/images/logo.svg" class="company-logo" alt="西村総研" style="cursor: pointer;" onclick="startInvaders()" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-block';">
                                <div class="vintage-logo" style="display: none; cursor: pointer;" onclick="startInvaders()"></div>
                            </td>
                            <td>
                                <font size="4" face="KH-Dot-Hibiya, Chicago, Monaco" class="color-black">
                                    <b>Nishimura Souken</b>
                                </font><br>
                                <font size="1" class="color-darkgray pixel-text">
                                    Think Digital. Think Different.
                                </font><br>
                                <font size="1" class="color-gray">
                                    Since 1984 (really 2021) • Fukuoka, Japan
                                </font>
                            </td>
                        </tr>
                    </table>
                    
                    <hr size="1" color="#808080">
                    
                    <!-- Welcome Message -->
                    <div class="dialog-box">
                        <div class="dialog-title">Welcome to Digital Revolution</div>
                        <font size="2" face="KH-Dot-Hibiya, Chicago, Monaco">
                            デジタルマーケティングの全領域をカバーする統合ソリューション
                        </font>
                        <br><br>
                        <center>
                            <a href="#services" class="hypercard-button">View Services</a>
                            <a href="#contact" class="hypercard-button">Contact Us</a>
                        </center>
                    </div>
                    
                    <!-- ニュースティッカー -->
                    <table width="100%" cellpadding="5" cellspacing="0" border="1">
                        <tr bgcolor="#000000">
                            <td>
                                <font color="#00FF00" face="Monaco, Courier" size="1" class="pixel-text">
                                    <div style="overflow: hidden; white-space: nowrap;">
                                        <span class="marquee">
                                            *** NEWS: AI営業支援ツール「AIアポブースト」正規代理店認定 *** 新サービス「SHORT MEDIA」TikTok運用開始 *** 西村総研は創業3年目を迎えました ***
                                        </span>
                                    </div>
                                </font>
                            </td>
                        </tr>
                    </table>
                    
                    <br>
                    
                    <!-- サービス一覧 -->
                    <a name="services"></a>
                    <div class="dialog-box">
                        <div class="dialog-title">Service Portfolio - 12 Applications</div>
                        
                        <table width="100%" cellpadding="5" cellspacing="2" border="0" bgcolor="#808080">
                            <tr>
                                <td bgcolor="#FFFFFF" width="25%" class="mac-inset">
                                    <center>
                                        <font size="4">🛒</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>EC DESIGN</b></font><br>
                                        <font size="1" class="color-darkgray">ECサイト制作</font><br>
                                        <font size="1" class="color-darkgray">売上向上を重視したUI/UX設計</font>
                                    </center>
                                </td>
                                <td bgcolor="#FFFFFF" width="25%" class="mac-inset">
                                    <center>
                                        <font size="4">📊</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>LP DESIGN</b></font><br>
                                        <font size="1" class="color-darkgray">LP制作</font><br>
                                        <font size="1" class="color-darkgray">高CV率を実現するLP設計</font>
                                    </center>
                                </td>
                                <td bgcolor="#FFFFFF" width="25%" class="mac-inset">
                                    <center>
                                        <font size="4">🖥️</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>WEB CRAFT</b></font><br>
                                        <font size="1" class="color-darkgray">Webサイト制作</font><br>
                                        <font size="1" class="color-darkgray">ブランド価値を高めるサイト</font>
                                    </center>
                                </td>
                                <td bgcolor="#FFFFFF" width="25%" class="mac-inset">
                                    <center>
                                        <font size="4">⚙️</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>SYSTEM DEV</b></font><br>
                                        <font size="1" class="color-darkgray">システム開発</font><br>
                                        <font size="1" class="color-darkgray">業務効率化・DX推進</font>
                                    </center>
                                </td>
                            </tr>
                            <tr>
                                <td bgcolor="#FFFFFF" class="mac-inset">
                                    <center>
                                        <font size="4">📱</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>SNS BOOST</b></font><br>
                                        <font size="1" class="color-darkgray">SNSプロモーション</font><br>
                                        <font size="1" class="color-darkgray">認知・エンゲージメント最大化</font>
                                    </center>
                                </td>
                                <td bgcolor="#FFFFFF" class="mac-inset">
                                    <center>
                                        <font size="4">📺</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>YT GROWTH</b></font><br>
                                        <font size="1" class="color-darkgray">YouTube運用</font><br>
                                        <font size="1" class="color-darkgray">チャンネル設計から分析改善</font>
                                    </center>
                                </td>
                                <td bgcolor="#FFFFFF" class="mac-inset">
                                    <center>
                                        <font size="4">🎬</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>SHORT MEDIA</b></font><br>
                                        <font size="1" class="color-darkgray">TikTok/Instagram運用</font><br>
                                        <font size="1" class="color-darkgray">ショート動画でバズを創出</font>
                                    </center>
                                </td>
                                <td bgcolor="#FFFFFF" class="mac-inset">
                                    <center>
                                        <font size="4">🎯</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>CASTING HUB</b></font><br>
                                        <font size="1" class="color-darkgray">インフルエンサー</font><br>
                                        <font size="1" class="color-darkgray">最適なマッチングを実現</font>
                                    </center>
                                </td>
                            </tr>
                            <tr>
                                <td bgcolor="#FFFFFF" class="mac-inset">
                                    <center>
                                        <font size="4">🎥</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>VIDEO PROD</b></font><br>
                                        <font size="1" class="color-darkgray">映像制作</font><br>
                                        <font size="1" class="color-darkgray">企業VP・商品PR動画</font>
                                    </center>
                                </td>
                                <td bgcolor="#FFFFFF" class="mac-inset">
                                    <center>
                                        <font size="4">📸</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>PHOTO SHOOT</b></font><br>
                                        <font size="1" class="color-darkgray">スチール撮影</font><br>
                                        <font size="1" class="color-darkgray">商品・EC向け高品質撮影</font>
                                    </center>
                                </td>
                                <td bgcolor="#FFFFFF" class="mac-inset">
                                    <center>
                                        <font size="4">🎨</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>GRAPHIC DESIGN</b></font><br>
                                        <font size="1" class="color-darkgray">グラフィックデザイン</font><br>
                                        <font size="1" class="color-darkgray">ブランドアイデンティティ</font>
                                    </center>
                                </td>
                                <td bgcolor="#FFFFFF" class="mac-inset">
                                    <center>
                                        <font size="4">📈</font><br>
                                        <font size="1" face="KH-Dot-Hibiya, Chicago"><b>ADS MANAGE</b></font><br>
                                        <font size="1" class="color-darkgray">広告運用代理</font><br>
                                        <font size="1" class="color-darkgray">費用対効果の最大化</font>
                                    </center>
                                </td>
                            </tr>
                        </table>
                    </div>
                    
                    <br>
                    
                    <!-- About -->
                    <a name="about"></a>
                    <div class="dialog-box">
                        <div class="dialog-title">About This Company</div>
                        <font size="2" face="KH-Dot-Hibiya, Chicago, Monaco">
                            <b>Philosophy:</b><br>
                            各分野の専門チームがワンストップでアプローチ。<br>
                            統合的なマーケティングソリューションを提供します。<br><br>
                            
                            <b>Company Info:</b><br>
                            • Founded: 2021<br>
                            • Location: Fukuoka, Japan<br>
                            • Services: 12 Digital Solutions<br>
                            • Status: Active & Growing
                        </font>
                    </div>
                    
                    <!-- Partners -->
                    <div class="dialog-box">
                        <div class="dialog-title">Strategic Partnerships</div>
                        <table width="100%" cellpadding="10" cellspacing="0" border="0">
                            <tr>
                                <td bgcolor="#FFFFFF" class="mac-inset" align="center">
                                    <font size="2" face="Chicago"><b>AIアポブースト</b></font><br>
                                    <font size="1" class="color-darkgray">正規代理店認定</font><br><br>
                                    <a href="https://ns-souken.com" class="hypercard-button">Visit Site</a>
                                </td>
                            </tr>
                        </table>
                    </div>
                    
                    <!-- Contact -->
                    <a name="contact"></a>
                    <div class="dialog-box">
                        <div class="dialog-title">Contact Information</div>
                        <font size="2" face="KH-Dot-Hibiya, Chicago, Monaco">
                            <b>西村総研</b><br>
                            福岡県久留米市<br><br>
                            Email: kaito.nishimura@ns-souken.com<br><br>
                        </font>
                        <center>
                            <a href="mailto:kaito.nishimura@ns-souken.com" class="hypercard-button">Send Message</a>
                        </center>
                    </div>
                    
                    
                </td>
            </tr>
            
            <!-- ステータスバー -->
            <tr>
                <td class="title-bar" style="border-top: 1px solid #808080;">
                    <font size="1" face="Monaco, Courier" class="pixel-text">
                        Ready • 12 services loaded • Memory: 128K free
                    </font>
                </td>
                <td align="right" class="title-bar" style="border-top: 1px solid #808080; width: 200px;">
                    <font size="1" face="Monaco, Courier" class="pixel-text">
                        Visitors: 0000042 <span class="blink-vintage">_</span>
                    </font>
                </td>
            </tr>
        </table>
        
        <br>
        
        <!-- システム情報 -->
        <table cellpadding="3" cellspacing="0" border="1" bgcolor="#000000">
            <tr>
                <td>
                    <font color="#C0C0C0" face="Monaco, Courier" size="1" class="pixel-text">
                        System 6.0.7 Compatible • Requires 1MB RAM • HyperCard Stack
                    </font>
                </td>
            </tr>
        </table>
        
        <br>
        
        <!-- Webリング風ナビゲーション -->
        <table cellpadding="5" cellspacing="0" border="0">
            <tr>
                <td>
                    <a href="#" class="hypercard-button">&lt; Previous</a>
                </td>
                <td>
                    <font size="1" class="color-darkgray pixel-text">[ Classic Mac Software Ring ]</font>
                </td>
                <td>
                    <a href="#" class="hypercard-button">Next &gt;</a>
                </td>
            </tr>
        </table>
        
        <br>
        
        <!-- HyperCard風リンク -->
        <font size="1" class="color-darkgray pixel-text">
            This stack created with HyperCard • System 6.0.7+ Compatible<br>
            Best viewed on Macintosh Plus (1MB RAM) or later • 800x600 resolution<br><br>
            <a href="privacy.html" style="color: #666666; text-decoration: underline;">Privacy Policy</a>
        </font>
        
    </center>
    
    <!-- 超軽量インベーダーゲーム -->
    <div id="invaders-game" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999;">
        <canvas id="gameCanvas" style="display: block; margin: 0 auto; image-rendering: pixelated;"></canvas>
        <div style="position: absolute; top: 10px; left: 10px; color: #0F0; font-family: Monaco, monospace; font-size: 16px;">
            SCORE: <span id="score">0</span>
        </div>
        <div style="position: absolute; top: 10px; right: 10px; color: #0F0; font-family: Monaco, monospace; font-size: 16px;">
            LIVES: <span id="lives">3</span>
        </div>
        <div style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); color: #0F0; font-family: Monaco, monospace; font-size: 12px;">
            ARROW KEYS: MOVE • SPACE: FIRE • ESC: EXIT
        </div>
    </div>
    
    <script>
    // 超軽量インベーダーゲーム
    function startInvaders() {
        const gameDiv = document.getElementById('invaders-game');
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const livesEl = document.getElementById('lives');
        
        // ゲーム設定
        canvas.width = 320;
        canvas.height = 240;
        gameDiv.style.display = 'block';
        
        let player = {x: 160, y: 210, w: 20, h: 10};
        let bullets = [];
        let invaders = [];
        let invaderBullets = [];
        let score = 0;
        let lives = 3;
        let keys = {};
        let gameRunning = true;
        
        // インベーダー初期化
        for(let row = 0; row < 4; row++) {
            for(let col = 0; col < 8; col++) {
                invaders.push({
                    x: col * 35 + 30,
                    y: row * 25 + 30,
                    w: 20,
                    h: 15,
                    alive: true
                });
            }
        }
        
        // キー入力
        document.addEventListener('keydown', (e) => {
            keys[e.key] = true;
            if(e.key === 'Escape') endGame();
        });
        document.addEventListener('keyup', (e) => keys[e.key] = false);
        
        // ゲームループ
        let invaderDir = 1;
        let lastShot = 0;
        
        function gameLoop() {
            if(!gameRunning) return;
            
            // クリア
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // プレイヤー移動
            if(keys['ArrowLeft'] && player.x > 10) player.x -= 3;
            if(keys['ArrowRight'] && player.x < 310) player.x += 3;
            if(keys[' '] && Date.now() - lastShot > 300) {
                bullets.push({x: player.x, y: player.y, w: 2, h: 8});
                lastShot = Date.now();
            }
            
            // インベーダー移動
            let shouldDrop = false;
            for(let inv of invaders) {
                if(!inv.alive) continue;
                if(inv.x <= 10 || inv.x >= 290) shouldDrop = true;
            }
            
            if(shouldDrop) {
                invaderDir *= -1;
                invaders.forEach(inv => inv.y += 20);
            }
            
            invaders.forEach(inv => {
                if(inv.alive) inv.x += invaderDir * 0.5;
            });
            
            // インベーダー弾
            if(Math.random() < 0.01) {
                let aliveInvaders = invaders.filter(i => i.alive);
                if(aliveInvaders.length > 0) {
                    let shooter = aliveInvaders[Math.floor(Math.random() * aliveInvaders.length)];
                    invaderBullets.push({x: shooter.x + 10, y: shooter.y + 15, w: 2, h: 6});
                }
            }
            
            // 弾移動
            bullets = bullets.filter(b => {
                b.y -= 5;
                return b.y > 0;
            });
            
            invaderBullets = invaderBullets.filter(b => {
                b.y += 3;
                if(b.x > player.x - 10 && b.x < player.x + 10 && b.y > player.y - 5) {
                    lives--;
                    livesEl.textContent = lives;
                    if(lives <= 0) endGame();
                    return false;
                }
                return b.y < canvas.height;
            });
            
            // 衝突判定
            bullets = bullets.filter(bullet => {
                for(let inv of invaders) {
                    if(inv.alive && bullet.x > inv.x && bullet.x < inv.x + inv.w && 
                       bullet.y > inv.y && bullet.y < inv.y + inv.h) {
                        inv.alive = false;
                        score += 10;
                        scoreEl.textContent = score;
                        return false;
                    }
                }
                return true;
            });
            
            // 描画
            ctx.fillStyle = '#0F0';
            
            // プレイヤー
            ctx.fillRect(player.x - 10, player.y, 20, 5);
            ctx.fillRect(player.x - 5, player.y - 5, 10, 5);
            ctx.fillRect(player.x - 2, player.y - 8, 4, 3);
            
            // インベーダー
            invaders.forEach(inv => {
                if(inv.alive) {
                    // シンプルなインベーダー形状
                    ctx.fillRect(inv.x + 2, inv.y, 16, 5);
                    ctx.fillRect(inv.x, inv.y + 5, 20, 5);
                    ctx.fillRect(inv.x + 2, inv.y + 10, 4, 5);
                    ctx.fillRect(inv.x + 14, inv.y + 10, 4, 5);
                }
            });
            
            // 弾
            bullets.forEach(b => ctx.fillRect(b.x, b.y, b.w, b.h));
            invaderBullets.forEach(b => ctx.fillRect(b.x, b.y, b.w, b.h));
            
            // 勝利判定
            if(invaders.every(i => !i.alive)) {
                ctx.fillStyle = '#0F0';
                ctx.font = '20px Monaco';
                ctx.fillText('YOU WIN!', 120, 120);
                setTimeout(endGame, 2000);
                return;
            }
            
            requestAnimationFrame(gameLoop);
        }
        
        function endGame() {
            gameRunning = false;
            gameDiv.style.display = 'none';
            document.removeEventListener('keydown', arguments.callee);
            document.removeEventListener('keyup', arguments.callee);
        }
        
        gameLoop();
    }
    </script>
</body>
</html>